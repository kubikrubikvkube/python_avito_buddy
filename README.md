# python_avito_buddy

Парсинг объявлений , хранение их в MongoDB , анализ и экспорт в CSV для дальнейшего процессинга специалистами по продажам.

### Получаем список объявлений в короткой форме (e.g.)
```
{
   'category':{
      'id':<...>,
      'name':'Постельное бельё и принадлежности'
   },
   'coords':{
      'lat':'<...>',
      'lng':'<...>'
   },
   'id':<...>,
   'images':{
      'count':5,
      'main':{
         '100x75':'<...>',
         '1280x960':'<...>',
         '140x105':'<...>',
         '240x180':'<...>',
         '432x324':'<...>',
         '640x480':'<...>'
      }
   },
   'isFavorite':False,
   'isVerified':False,
   'location':'Санкт-Петербург',
   'price':'4 100 руб.',
   'time':1562222700,
   'title':'Декор на выписку из роддома',
   'uri':'<...>',
   'userType':'private'
}
```
### Сохраняем полученные данные в таблицу PostgreSQL формата
| id  | time | is_detailed |
| ------------- | ------------- |
| 233456  | 1467453366  | true |
| 663345  | 1498989366  | false |

### Получаем список объявлений в детализированной форме (e.g.) используя сохранённые id
```
{
   'id':<...>,
   'categoryId':<...>,
   'locationId':<...>,
   'metroId':<...>,
   'metroType':'text',
   'sharing':{
      'fb':'<...>',
      'gp':'<...>',
      'lj':'<...>',
      'mm':'<...>',
      'native':'<...>',
      'ok':'<...>',
      'tw':'<...>',
      'vk':'<...>',
      'url':'<...>
   },
   'coords':{
      'lat':<...>,
      'lng':<...>
   },
   'address':'Санкт-Петербург, м. Девяткино',
   'title':'Декор на выписку из роддома',
   'userType':'private',
   'time':1561122620,
   'description':'Набор на выписку из роддома . В набор входят : Объёмные буквы  BABY , карета и розовая колясочка',
   'parameters':{
      'flat':[
         {
            'title':'Категория',
            'description':'Товары для детей и игрушки'
         },
         {
            'title':'Вид товара',
            'description':'Постельные принадлежности'
         },
         {
            'title':'Состояние',
            'description':'Б/у'
         }
      ],
      'groups':[

      ]
   },
   'images':[
      {
         '100x75':'<...>',
         '140x105':'<...>',
         '240x180':'<...>',
         '432x324':'<...>',
         '640x480':'<...>'
      },
      {
         '100x75':'<...>',
         '140x105':'<...>',
         '240x180':'<...>',
         '432x324':'<...>',
         '640x480':'<...>'
      },
      {
         '100x75':'<...>',
         '140x105':'<...>',
         '240x180':'<...>',
         '432x324':'<...>',
         '640x480':'<...>'
      },
      {
         '100x75':'<...>',
         '140x105':'<...>',
         '240x180':'<...>',
         '432x324':'<...>',
         '640x480':'<...>'
      },
      {
         '100x75':'<...>',
         '140x105':'<...>',
         '240x180':'<...>',
         '432x324':'<...>',
         '640x480':'<...>'
      },
      {
         '100x75':'<...>',
         '140x105':'<...>',
         '240x180':'<...>',
         '432x324':'<...>',
         '640x480':'<...>'
      },
      {
         '100x75':'<...>',
         '140x105':'<...>',
         '240x180':'<...>',
         '432x324':'<...>',
         '640x480':'<...>'
      }
   ],
   'price':{
      'title':'Цена',
      'value':'4 100',
      'metric':'руб.'
   },
   'seller':{
      'title':'Частное лицо',
      'name':'Ольга',
      'connection':{
         'title':'Подтверждён',
         'sources':[
            {
               'type':'phone'
            },
            {
               'type':'email'
            }
         ]
      },
      'link':'<...>',
      'images':{
         '24x24':'<...>',
         '36x36':'<...>',
         '48x48':'<...>',
         '64x64':'<...>',
         '72x72':'<...>',
         '96x96':'<...>',
         '128x128':'<...>',
         '192x192':'<...>',
         '256x256':'<...>'
      },
      'summary':'20 объявлений',
      'postfix':'Частное лицо',
      'userHashId':'617118',
      'online':False
   },
   'stats':{
      'views':{
         'today':1,
         'total':520
      }
   },
   'contacts':{
      'list':[
         {
            'type':'phone',
            'value':{
               'title':'Позвонить',
               'uri':'ru.avito://1/phone/call?number=<...>'
            }
         },
         {
            'type':'messenger',
            'value':{
               'title':'Написать',
               'uri':'ru.avito://1/item/channel/create?itemId=<...>'
            }
         }
      ]
   },
   'needToCheckCreditInfo':True,
   'firebaseParams':{
      'itemID':'<...>',
      'itemPrice':'4100',
      'withDelivery':'1',
      'vid_tovara':'Постельные принадлежности',
      'goods_condition':'Б/у',
      'type_of_trade':'Продаю своё',
      'userAuth':'0',
      'isShop':'0',
      'isASDClient':'0',
      'vertical':'GENERAL',
      'categoryId':'30',
      'categorySlug':'tovary_dlya_detey_i_igrushki',
      'microCategoryId':'278',
      'locationId':'<...>'
   },
   'adjustParams':{
      'categoryId':'30',
      'vertical':'GENERAL',
      'microCategoryId':'278'
   }
}
```
Сохраняем полученные объявления в коллекцию MongoDB
